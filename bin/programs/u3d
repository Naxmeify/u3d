#!/usr/bin/env node

// requirements
var root = "../../";
var program = require('commander');
var pkg = require(root + 'package.json');
var lib = root + 'lib/';

var u3d = require(lib + 'u3d');

// version
program.version(pkg.version);

// usage
program.usage('[command] [options]');

// options
program.option('-v, --verbose', 'Show complete output');

// on help

// commands
// -- run
program.command('run')
.description('Start Unity3D')
.action(function(cmd) {
  console.log(cmd);
  console.log('run');
  u3d.run();
});

// -- install
program.command('install')
.description('Install Unity3D from internet')
.option('-r, --release <version>', 'Define Unity3D Version (latest version is default).')
.option('-s, --silent', 'Performs a silent (no questions asked) install (Windows only).')
.option('-d, --dist <path>', 'Sets the default install directory. Useful when combined with the silent install option. (Windows only).')
.action(function(cmd) {
  u3d.install(cmd.release, cmd.dist, cmd.silent, function(err, data) {
    if(err) {
      if(err == 404) {
        console.log("Unity3D Setup not found. Pick other version or install latest version.");
        console.log("Checkout 'u3d install --help' for more information");
      }
    }
  });
});

// unknown command
program.on('*', function() {
  console.log('Unknown Command');
});

// parse
program.parse(process.argv);

// default Action
if (program.args.length < 1 ) {
  u3d.run();
}
